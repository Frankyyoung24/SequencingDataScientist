---
title: "Command Line Tools for Genomic Data Science: Week 2"
---
## Module 2 Exam Instructions

>For this project, it is recommended that you use the VMBox virtual environment provided with the Course package and the tools therein. You may also use your own system and software, however make sure that appropriate versions are installed. The answers are compatible with the following versions of the software: samtools v.1.2, bedtools v.2.24.0.

>As part of a larger project cataloging genetic variation in the plant Arabidopsis thaliana, you sequenced and assembled the genome of one strain (‘wu_0_A’), then mapped back the reads to the assembled genome. The resulting BAM file is included in the package ‘gencommand_proj2\_data.tar.gz’. Using SAMtools and BEDtools as well as other Unix commands introduced in this course, examine the files and answer the following questions. NOTE: Input data have been obtained and modified from those generated by the 1001 Genomes Project, accession ‘Wu\_0\_A’.

> [Click here to download the Project 2 Data Files][https://d396qusza40orc.cloudfront.net/gencommand/gencommand_proj2_data.tar.gz]

> Apply these rules and steps to the questions marked above each rule.

> **Questions 1 - 5:**

> For the original set of alignments (file ‘athal_wu_0_A.bam’):

> **Questions 6 - 10:**

> Extract only the alignments in the range “Chr3:11,777,000-11,794,000”, corresponding to a locus of interest. For this alignment set:

> **Questions 11 - 15:**

> Determine general information about the alignment process from the original BAM file.

> **Questions 16 - 20:**

> Using BEDtools, examine how many of the alignments at point 2 overlap exons at the locus of interest. Use the BEDtools ‘-wo’ option to only report non-zero overlaps. The list of exons is given in the included ‘athal_wu_0_A_annot.gtf’ GTF file.

## Quiz

1. How many alignments does the set contain?

   `samtools view athal_wu_0_A.bam | wc -l`

2. How many alignments show the read’s mate unmapped?

   `samtools view athal_wu_0_A.bam | cut -f7 | grep "*" | wc -l`

3. How many alignments contain a deletion (D)?

   `samtools view athal_wu_0_A.bam | cut -f6 | grep "D" | wc -l`

4. How many alignments show the read’s mate mapped to the same chromosome?

   `samtools view athal_wu_0_A.bam | cut -f7 | grep "=" | wc -l`

5. How many alignments are spliced?

   `samtools view athal_wu_0_A.bam | cut -f6 | grep "N" | wc -l`

6. How many alignments does the set contain?

   First: (-h is for include header in SAM output file)

   `samtools view -h -b athal_wu_0_A.bam "Chr3:11777000-11794000" -o athal_wu_0_A_Chr3.bam`

   Then:

   `samtools view athal_wu_0_A_Chr3.bam | wc -l`

7. How many alignments show the read’s mate unmapped?

   `samtools view athal_wu_0_A_Chr3.bam | cut -f7 | grep "*" | wc -l`

8. How many alignments contain a deletion (D)?

   `samtools view athal_wu_0_A_Chr3.bam | cut -f6 | grep "D" | wc -l`

9. How many alignments show the read’s mate mapped to the same chromosome?

   `samtools view athal_wu_0_A_Chr3.bam | cut -f7 | grep "=" | wc -l`

10. How many alignments are spliced?

   `samtools view athal_wu_0_A_Chr3.bam | cut -f6 | grep "N" | wc -l`

11. How many sequences are in the genome file?

   `samtools view -H athal_wu_0_A.bam | grep "SQ" | wc -l`

12. What is the length of the first sequence in the genome file?

   `samtools view -H athal_wu_0_A.bam`

13. What alignment tool was used?

   `samtools view -H athal_wu_0_A.bam`

14. What is the read identifier (name) for the first alignment?

   `samtools view -H athal_wu_0_A.bam`

15. What is the start position of this read’s mate on the genome? Give this as ‘chrom:pos’ if the read was mapped, or ‘*” if unmapped.

   `samtools view athal_wu_0_A.bam | head`

16. How many overlaps (each overlap is reported on one line) are reported?

   First:

   `bedtools bamtobed -i  athal_wu_0_A.bam > athal_wu_0_A.bed`

   Then:

   `bedtools intersect -wo -a athal_wu_0_A_annot.gtf -b athal_wu_0_A.bed | wc -l`

17. How many of these are 10 bases or longer?

   `bedtools intersect -wo -a athal_wu_0_A_annot.gtf -b athal_wu_0_A.bed | cut -f16 | grep "[1-9][0-9]" | wc -l`

18. How many alignments overlap the annotations?

   `bedtools intersect -wo -a athal_wu_0_A_annot.gtf -b athal_wu_0_A.bed | wc -l`

19. Conversely, how many exons have reads mapped to them?

   `bedtools intersect -c -a athal_wu_0_A_annot.gtf -b athal_wu_0_A.bed | cut -f13-21 | sort -u | wc -l`

20. If you were to convert the transcript annotations in the file “athal_wu\_0_A_annot.gtf” into BED format, how many BED records would be generated?

   `bedtools intersect -c -a athal_wu_0_A_annot.gtf -b athal_wu_0_A.bed | cut -f9 | cut -d " " -f4 | sort -u | wc -l`







The END.